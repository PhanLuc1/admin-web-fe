{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/esm/regeneratorRuntime\";\nimport _toArray from \"@babel/runtime/helpers/esm/toArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nvar _excluded = [\"map_row_parentKey\"],\n  _excluded2 = [\"map_row_parentKey\", \"map_row_key\"],\n  _excluded3 = [\"map_row_key\"];\n/* eslint-disable react-hooks/exhaustive-deps */\nimport { LoadingOutlined } from '@ant-design/icons';\nimport { useIntl } from '@ant-design/pro-provider';\nimport { Form, Popconfirm, message } from 'antd';\nimport useLazyKVMap from \"antd/es/table/hooks/useLazyKVMap\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport get from \"rc-util/es/utils/get\";\nimport set from \"rc-util/es/utils/set\";\nimport { noteOnce } from \"rc-util/es/warning\";\nimport React, { createRef, forwardRef, useContext, useEffect, useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport { useDebounceFn, useRefFunction } from '..';\nimport { ProFormContext } from \"../components/ProFormContext\";\nimport { useDeepCompareEffectDebounce } from \"../hooks/useDeepCompareEffect\";\nimport { usePrevious } from \"../hooks/usePrevious\";\nimport { merge } from \"../merge\";\nimport { useMountMergeState } from \"../useMountMergeState\";\n\n/**\n * 兼容antd@4 和 antd@5 的warning\n * @param messageStr\n */\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar warning = function warning(messageStr) {\n  // @ts-ignore\n  return (message.warn || message.warning)(messageStr);\n};\nexport var recordKeyToString = function recordKeyToString(rowKey) {\n  if (Array.isArray(rowKey)) return rowKey.join(',');\n  return rowKey;\n};\n/**\n * 使用map 来删除数据，性能一般 但是准确率比较高\n *\n * @param keyProps\n * @param action\n */\nexport function editableRowByKey(keyProps, action) {\n  var _recordKeyToString;\n  var getRowKey = keyProps.getRowKey,\n    row = keyProps.row,\n    data = keyProps.data,\n    _keyProps$childrenCol = keyProps.childrenColumnName,\n    childrenColumnName = _keyProps$childrenCol === void 0 ? 'children' : _keyProps$childrenCol;\n  var key = (_recordKeyToString = recordKeyToString(keyProps.key)) === null || _recordKeyToString === void 0 ? void 0 : _recordKeyToString.toString();\n  var kvMap = new Map();\n\n  /**\n   * 打平这个数组\n   *\n   * @param records\n   * @param parentKey\n   */\n  function dig(records, map_row_parentKey, map_row_index) {\n    records.forEach(function (record, index) {\n      var eachIndex = (map_row_index || 0) * 10 + index;\n      var recordKey = getRowKey(record, eachIndex).toString();\n      // children 取在前面方便拼的时候按照反顺序放回去\n      if (record && _typeof(record) === 'object' && childrenColumnName in record) {\n        dig(record[childrenColumnName] || [], recordKey, eachIndex);\n      }\n      var newRecord = _objectSpread(_objectSpread({}, record), {}, {\n        map_row_key: recordKey,\n        children: undefined,\n        map_row_parentKey: map_row_parentKey\n      });\n      delete newRecord.children;\n      if (!map_row_parentKey) {\n        delete newRecord.map_row_parentKey;\n      }\n      kvMap.set(recordKey, newRecord);\n    });\n  }\n  if (action === 'top') {\n    kvMap.set(key, _objectSpread(_objectSpread({}, kvMap.get(key)), row));\n  }\n  dig(data);\n  if (action === 'update') {\n    kvMap.set(key, _objectSpread(_objectSpread({}, kvMap.get(key)), row));\n  }\n  if (action === 'delete') {\n    kvMap.delete(key);\n  }\n  var fill = function fill(map) {\n    var kvArrayMap = new Map();\n    var kvSource = [];\n    var fillNewRecord = function fillNewRecord() {\n      var fillChildren = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      map.forEach(function (value) {\n        if (value.map_row_parentKey && !value.map_row_key) {\n          var map_row_parentKey = value.map_row_parentKey,\n            rest = _objectWithoutProperties(value, _excluded);\n          if (!kvArrayMap.has(map_row_parentKey)) {\n            kvArrayMap.set(map_row_parentKey, []);\n          }\n          if (fillChildren) {\n            var _kvArrayMap$get;\n            (_kvArrayMap$get = kvArrayMap.get(map_row_parentKey)) === null || _kvArrayMap$get === void 0 || _kvArrayMap$get.push(rest);\n          }\n        }\n      });\n    };\n    fillNewRecord(action === 'top');\n    map.forEach(function (value) {\n      if (value.map_row_parentKey && value.map_row_key) {\n        var _kvArrayMap$get2;\n        var map_row_parentKey = value.map_row_parentKey,\n          map_row_key = value.map_row_key,\n          rest = _objectWithoutProperties(value, _excluded2);\n        if (kvArrayMap.has(map_row_key)) {\n          rest[childrenColumnName] = kvArrayMap.get(map_row_key);\n        }\n        if (!kvArrayMap.has(map_row_parentKey)) {\n          kvArrayMap.set(map_row_parentKey, []);\n        }\n        (_kvArrayMap$get2 = kvArrayMap.get(map_row_parentKey)) === null || _kvArrayMap$get2 === void 0 || _kvArrayMap$get2.push(rest);\n      }\n    });\n    fillNewRecord(action === 'update');\n    map.forEach(function (value) {\n      if (!value.map_row_parentKey) {\n        var map_row_key = value.map_row_key,\n          rest = _objectWithoutProperties(value, _excluded3);\n        if (map_row_key && kvArrayMap.has(map_row_key)) {\n          var item = _objectSpread(_objectSpread({}, rest), {}, _defineProperty({}, childrenColumnName, kvArrayMap.get(map_row_key)));\n          kvSource.push(item);\n          return;\n        }\n        kvSource.push(rest);\n      }\n    });\n    return kvSource;\n  };\n  return fill(kvMap);\n}\n\n/**\n * 保存按钮的dom\n *\n * @param ActionRenderConfig\n */\nexport function SaveEditableAction(_ref, ref) {\n  var recordKey = _ref.recordKey,\n    onSave = _ref.onSave,\n    row = _ref.row,\n    children = _ref.children,\n    newLineConfig = _ref.newLineConfig,\n    editorType = _ref.editorType,\n    tableName = _ref.tableName;\n  var context = useContext(ProFormContext);\n  var form = Form.useFormInstance();\n  var _useMountMergeState = useMountMergeState(false),\n    _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n    loading = _useMountMergeState2[0],\n    setLoading = _useMountMergeState2[1];\n  var save = useRefFunction(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n    var _context$getFieldForm, isMapEditor, namePath, fields, _recordKey, recordKeyPath, curValue, data, res;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          isMapEditor = editorType === 'Map'; // 为了兼容类型为 array 的 dataIndex,当 recordKey 是一个数组时，用于获取表单值的 key 只取第一项，\n          // 从表单中获取回来之后，再根据 namepath 获取具体的某个字段并设置\n          namePath = [tableName, Array.isArray(recordKey) ? recordKey[0] : recordKey].map(function (key) {\n            return key === null || key === void 0 ? void 0 : key.toString();\n          }).flat(1).filter(Boolean);\n          setLoading(true);\n          _context.next = 6;\n          return form.validateFields(namePath, {\n            recursive: true\n          });\n        case 6:\n          fields = (context === null || context === void 0 || (_context$getFieldForm = context.getFieldFormatValue) === null || _context$getFieldForm === void 0 ? void 0 : _context$getFieldForm.call(context, namePath)) || form.getFieldValue(namePath); // 处理 dataIndex 为数组的情况\n          if (Array.isArray(recordKey) && recordKey.length > 1) {\n            // 获取 namepath\n            _recordKey = _toArray(recordKey), recordKeyPath = _recordKey.slice(1); // 将目标值获取出来并设置到 fields 当中\n            curValue = get(fields, recordKeyPath);\n            set(fields, recordKeyPath, curValue);\n          }\n          data = isMapEditor ? set({}, namePath, fields) : fields; // 获取数据并保存\n          _context.next = 11;\n          return onSave === null || onSave === void 0 ? void 0 : onSave(recordKey,\n          // 如果是 map 模式，fields 就是一个值，所以需要set 到对象中\n          // 数据模式 fields 是一个对象，所以不需要\n          merge({}, row, data), row, newLineConfig);\n        case 11:\n          res = _context.sent;\n          setLoading(false);\n          return _context.abrupt(\"return\", res);\n        case 16:\n          _context.prev = 16;\n          _context.t0 = _context[\"catch\"](0);\n          // eslint-disable-next-line no-console\n          console.log(_context.t0);\n          setLoading(false);\n          throw _context.t0;\n        case 21:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee, null, [[0, 16]]);\n  })));\n\n  // 保存数据\n  useImperativeHandle(ref, function () {\n    return {\n      save: save\n    };\n  }, [save]);\n  return /*#__PURE__*/_jsxs(\"a\", {\n    onClick: (/*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e) {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              e.stopPropagation();\n              e.preventDefault();\n              _context2.prev = 2;\n              _context2.next = 5;\n              return save();\n            case 5:\n              _context2.next = 9;\n              break;\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](2);\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[2, 7]]);\n      }));\n      return function (_x) {\n        return _ref3.apply(this, arguments);\n      };\n    }()),\n    children: [loading ? /*#__PURE__*/_jsx(LoadingOutlined, {\n      style: {\n        marginInlineEnd: 8\n      }\n    }) : null, children || '保存']\n  }, \"save\");\n}\n/**\n * 删除按钮 dom\n *\n * @param ActionRenderConfig\n */\nexport var DeleteEditableAction = function DeleteEditableAction(_ref4) {\n  var recordKey = _ref4.recordKey,\n    onDelete = _ref4.onDelete,\n    preEditRowRef = _ref4.preEditRowRef,\n    row = _ref4.row,\n    children = _ref4.children,\n    deletePopconfirmMessage = _ref4.deletePopconfirmMessage;\n  var _useMountMergeState3 = useMountMergeState(function () {\n      return false;\n    }),\n    _useMountMergeState4 = _slicedToArray(_useMountMergeState3, 2),\n    loading = _useMountMergeState4[0],\n    setLoading = _useMountMergeState4[1];\n  var _onConfirm = useRefFunction(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n    var res;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          setLoading(true);\n          _context3.next = 4;\n          return onDelete === null || onDelete === void 0 ? void 0 : onDelete(recordKey, row);\n        case 4:\n          res = _context3.sent;\n          setLoading(false);\n          return _context3.abrupt(\"return\", res);\n        case 9:\n          _context3.prev = 9;\n          _context3.t0 = _context3[\"catch\"](0);\n          // eslint-disable-next-line no-console\n          console.log(_context3.t0);\n          setLoading(false);\n          return _context3.abrupt(\"return\", null);\n        case 14:\n          _context3.prev = 14;\n          if (preEditRowRef) preEditRowRef.current = null;\n          return _context3.finish(14);\n        case 17:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3, null, [[0, 9, 14, 17]]);\n  })));\n  return children !== false ? /*#__PURE__*/_jsx(Popconfirm, {\n    title: deletePopconfirmMessage,\n    onConfirm: function onConfirm() {\n      return _onConfirm();\n    },\n    children: /*#__PURE__*/_jsxs(\"a\", {\n      children: [loading ? /*#__PURE__*/_jsx(LoadingOutlined, {\n        style: {\n          marginInlineEnd: 8\n        }\n      }) : null, children || '删除']\n    })\n  }, \"delete\") : null;\n};\nvar CancelEditableAction = function CancelEditableAction(props) {\n  var recordKey = props.recordKey,\n    tableName = props.tableName,\n    newLineConfig = props.newLineConfig,\n    editorType = props.editorType,\n    onCancel = props.onCancel,\n    cancelEditable = props.cancelEditable,\n    row = props.row,\n    cancelText = props.cancelText,\n    preEditRowRef = props.preEditRowRef;\n  var context = useContext(ProFormContext);\n  var form = Form.useFormInstance();\n  return /*#__PURE__*/_jsx(\"a\", {\n    onClick: (/*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(e) {\n        var _context$getFieldForm2;\n        var isMapEditor, namePath, fields, record, res, _props$onDelete;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              e.stopPropagation();\n              e.preventDefault();\n              isMapEditor = editorType === 'Map';\n              namePath = [tableName, recordKey].flat(1).filter(Boolean);\n              fields = (context === null || context === void 0 || (_context$getFieldForm2 = context.getFieldFormatValue) === null || _context$getFieldForm2 === void 0 ? void 0 : _context$getFieldForm2.call(context, namePath)) || (form === null || form === void 0 ? void 0 : form.getFieldValue(namePath));\n              record = isMapEditor ? set({}, namePath, fields) : fields;\n              _context4.next = 8;\n              return onCancel === null || onCancel === void 0 ? void 0 : onCancel(recordKey, record, row, newLineConfig);\n            case 8:\n              res = _context4.sent;\n              _context4.next = 11;\n              return cancelEditable(recordKey);\n            case 11:\n              if (!((preEditRowRef === null || preEditRowRef === void 0 ? void 0 : preEditRowRef.current) !== null)) {\n                _context4.next = 15;\n                break;\n              }\n              form.setFieldsValue(set({}, namePath, preEditRowRef === null || preEditRowRef === void 0 ? void 0 : preEditRowRef.current));\n              _context4.next = 17;\n              break;\n            case 15:\n              _context4.next = 17;\n              return (_props$onDelete = props.onDelete) === null || _props$onDelete === void 0 ? void 0 : _props$onDelete.call(props, recordKey, row);\n            case 17:\n              if (preEditRowRef) preEditRowRef.current = null;\n              return _context4.abrupt(\"return\", res);\n            case 19:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4);\n      }));\n      return function (_x2) {\n        return _ref6.apply(this, arguments);\n      };\n    }()),\n    children: cancelText || '取消'\n  }, \"cancel\");\n};\nexport function defaultActionRender(row, config) {\n  var recordKey = config.recordKey,\n    newLineConfig = config.newLineConfig,\n    saveText = config.saveText,\n    deleteText = config.deleteText;\n  var SaveEditableActionRef = /*#__PURE__*/forwardRef(SaveEditableAction);\n  var saveRef = /*#__PURE__*/createRef();\n  return {\n    save: /*#__PURE__*/_jsx(SaveEditableActionRef, _objectSpread(_objectSpread({}, config), {}, {\n      row: row,\n      ref: saveRef,\n      children: saveText\n    }), 'save' + recordKey),\n    saveRef: saveRef,\n    delete: (newLineConfig === null || newLineConfig === void 0 ? void 0 : newLineConfig.options.recordKey) !== recordKey ? /*#__PURE__*/_jsx(DeleteEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n      row: row,\n      children: deleteText\n    }), 'delete' + recordKey) : undefined,\n    cancel: /*#__PURE__*/_jsx(CancelEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n      row: row\n    }), 'cancel' + recordKey)\n  };\n}\n\n/**\n * 一个方便的hooks 用于维护编辑的状态\n *\n * @param props\n */\nexport function useEditableArray(props) {\n  // Internationalization\n  var intl = useIntl();\n\n  /**\n   * 点击开始编辑之前的保存数据用的\n   */\n  var preEditRowRef = useRef(null);\n  var _useState = useState(undefined),\n    _useState2 = _slicedToArray(_useState, 2),\n    newLineRecordCache = _useState2[0],\n    setNewLineRecordCache = _useState2[1];\n  var resetMapRef = function resetMapRef() {\n    var map = new Map();\n    //存在children时会覆盖Map的key,导致使用数组索引查找key错误\n    var loopGetKey = function loopGetKey(dataSource, parentKey) {\n      dataSource === null || dataSource === void 0 || dataSource.forEach(function (record, index) {\n        var _recordKeyToString2;\n        var key = parentKey === undefined || parentKey === null ? index.toString() : parentKey + '_' + index.toString();\n        map.set(key, recordKeyToString(props.getRowKey(record, -1)));\n        map.set((_recordKeyToString2 = recordKeyToString(props.getRowKey(record, -1))) === null || _recordKeyToString2 === void 0 ? void 0 : _recordKeyToString2.toString(), key);\n        if (props.childrenColumnName && record !== null && record !== void 0 && record[props.childrenColumnName]) {\n          loopGetKey(record[props.childrenColumnName], key);\n        }\n      });\n    };\n    loopGetKey(props.dataSource);\n    return map;\n  };\n  var initDataSourceKeyIndexMap = useMemo(function () {\n    return resetMapRef();\n  }, []);\n  var dataSourceKeyIndexMapRef = useRef(initDataSourceKeyIndexMap);\n  var newLineRecordRef = useRef(undefined);\n  useDeepCompareEffectDebounce(function () {\n    dataSourceKeyIndexMapRef.current = resetMapRef();\n  }, [props.dataSource]);\n\n  // 这里这么做是为了存上次的状态，不然每次存一下再拿\n  newLineRecordRef.current = newLineRecordCache;\n  var editableType = props.type || 'single';\n  var _useLazyKVMap = useLazyKVMap(props.dataSource, 'children', props.getRowKey),\n    _useLazyKVMap2 = _slicedToArray(_useLazyKVMap, 1),\n    getRecordByKey = _useLazyKVMap2[0];\n  var _useMergedState = useMergedState([], {\n      value: props.editableKeys,\n      onChange: props.onChange ? function (keys) {\n        var _props$onChange, _keys$filter, _keys$map$filter;\n        props === null || props === void 0 || (_props$onChange = props.onChange) === null || _props$onChange === void 0 || _props$onChange.call(props,\n        // 计算编辑的key\n        (_keys$filter = keys === null || keys === void 0 ? void 0 : keys.filter(function (key) {\n          return key !== undefined;\n        })) !== null && _keys$filter !== void 0 ? _keys$filter : [],\n        // 计算编辑的行\n        (_keys$map$filter = keys === null || keys === void 0 ? void 0 : keys.map(function (key) {\n          return getRecordByKey(key);\n        }).filter(function (key) {\n          return key !== undefined;\n        })) !== null && _keys$map$filter !== void 0 ? _keys$map$filter : []);\n      } : undefined\n    }),\n    _useMergedState2 = _slicedToArray(_useMergedState, 2),\n    editableKeys = _useMergedState2[0],\n    setEditableRowKeys = _useMergedState2[1];\n\n  /** 一个用来标志的set 提供了方便的 api 来去重什么的 */\n  var editableKeysSet = useMemo(function () {\n    var keys = editableType === 'single' ? editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.slice(0, 1) : editableKeys;\n    return new Set(keys);\n  }, [(editableKeys || []).join(','), editableType]);\n  var editableKeysRef = usePrevious(editableKeys);\n\n  /** 这行是不是编辑状态 */\n  var isEditable = useRefFunction(function (row) {\n    var _props$getRowKey, _props$getRowKey$toSt, _props$getRowKey2, _props$getRowKey2$toS;\n    // 为了兼容一下name 模式的 indexKey，所以需要判断两次，一次是index，一次是没有 index 的\n    var recordKeyOrIndex = (_props$getRowKey = props.getRowKey(row, row.index)) === null || _props$getRowKey === void 0 || (_props$getRowKey$toSt = _props$getRowKey.toString) === null || _props$getRowKey$toSt === void 0 ? void 0 : _props$getRowKey$toSt.call(_props$getRowKey);\n    // 这里是不设置 index 的地方\n    var recordKey = (_props$getRowKey2 = props.getRowKey(row, -1)) === null || _props$getRowKey2 === void 0 || (_props$getRowKey2$toS = _props$getRowKey2.toString) === null || _props$getRowKey2$toS === void 0 ? void 0 : _props$getRowKey2$toS.call(_props$getRowKey2);\n\n    // 都转化为了字符串，不然 number 和 string\n    var stringEditableKeys = editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.map(function (key) {\n      return key === null || key === void 0 ? void 0 : key.toString();\n    });\n    var stringEditableKeysRef = (editableKeysRef === null || editableKeysRef === void 0 ? void 0 : editableKeysRef.map(function (key) {\n      return key === null || key === void 0 ? void 0 : key.toString();\n    })) || [];\n    var preIsEditable = props.tableName && !!(stringEditableKeysRef !== null && stringEditableKeysRef !== void 0 && stringEditableKeysRef.includes(recordKey)) || !!(stringEditableKeysRef !== null && stringEditableKeysRef !== void 0 && stringEditableKeysRef.includes(recordKeyOrIndex));\n    return {\n      recordKey: recordKey,\n      isEditable: props.tableName && (stringEditableKeys === null || stringEditableKeys === void 0 ? void 0 : stringEditableKeys.includes(recordKey)) || (stringEditableKeys === null || stringEditableKeys === void 0 ? void 0 : stringEditableKeys.includes(recordKeyOrIndex)),\n      preIsEditable: preIsEditable\n    };\n  });\n\n  /**\n   * 进入编辑状态\n   *\n   * @param recordKey\n   */\n  var startEditable = useRefFunction(function (recordKey, record) {\n    var _ref7, _props$dataSource;\n    // 如果是单行的话，不允许多行编辑\n    if (editableKeysSet.size > 0 && editableType === 'single' && props.onlyOneLineEditorAlertMessage !== false) {\n      warning(props.onlyOneLineEditorAlertMessage || intl.getMessage('editableTable.onlyOneLineEditor', '只能同时编辑一行'));\n      return false;\n    }\n    editableKeysSet.add(recordKey);\n    setEditableRowKeys(Array.from(editableKeysSet));\n\n    // 这里是为了存上次的状态,不然取消的时候就丢掉了\n    preEditRowRef.current = (_ref7 = record !== null && record !== void 0 ? record : (_props$dataSource = props.dataSource) === null || _props$dataSource === void 0 ? void 0 : _props$dataSource.find(function (recordData, index) {\n      return props.getRowKey(recordData, index) === recordKey;\n    })) !== null && _ref7 !== void 0 ? _ref7 : null;\n    return true;\n  });\n\n  /**\n   * 退出编辑状态\n   *\n   * @param recordKey\n   */\n  var cancelEditable = useRefFunction(/*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(recordKey, needReTry) {\n      var relayKey, key;\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) switch (_context5.prev = _context5.next) {\n          case 0:\n            relayKey = recordKeyToString(recordKey).toString();\n            key = dataSourceKeyIndexMapRef.current.get(relayKey);\n            /** 如果没找到key，转化一下再去找 */\n            if (!(!editableKeysSet.has(relayKey) && key && (needReTry !== null && needReTry !== void 0 ? needReTry : true) && props.tableName)) {\n              _context5.next = 5;\n              break;\n            }\n            cancelEditable(key, false);\n            return _context5.abrupt(\"return\");\n          case 5:\n            /** 如果这个是 new Line 直接删除 */\n            if (newLineRecordCache && newLineRecordCache.options.recordKey === recordKey) {\n              setNewLineRecordCache(undefined);\n            }\n            editableKeysSet.delete(relayKey);\n            editableKeysSet.delete(recordKeyToString(recordKey));\n            setEditableRowKeys(Array.from(editableKeysSet));\n            return _context5.abrupt(\"return\", true);\n          case 10:\n          case \"end\":\n            return _context5.stop();\n        }\n      }, _callee5);\n    }));\n    return function (_x3, _x4) {\n      return _ref8.apply(this, arguments);\n    };\n  }());\n  var propsOnValuesChange = useDebounceFn(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n    var _props$onValuesChange;\n    var _len,\n      rest,\n      _key,\n      _args6 = arguments;\n    return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n      while (1) switch (_context6.prev = _context6.next) {\n        case 0:\n          for (_len = _args6.length, rest = new Array(_len), _key = 0; _key < _len; _key++) {\n            rest[_key] = _args6[_key];\n          }\n          //@ts-ignore\n          (_props$onValuesChange = props.onValuesChange) === null || _props$onValuesChange === void 0 || _props$onValuesChange.call.apply(_props$onValuesChange, [props].concat(rest));\n        case 2:\n        case \"end\":\n          return _context6.stop();\n      }\n    }, _callee6);\n  })), 64);\n  var onValuesChange = useRefFunction(function (value, values) {\n    var _Object$keys$pop;\n    if (!props.onValuesChange) {\n      return;\n    }\n    var dataSource = props.dataSource;\n\n    // 这里是把正在编辑中的所有表单数据都修改掉\n    // 不然会用 props 里面的 dataSource，数据只有正在编辑中的\n    // Object.keys(get(values, [props.tableName || ''].flat(1)) || values).forEach((recordKey) => {\n    editableKeys === null || editableKeys === void 0 || editableKeys.forEach(function (eachRecordKey) {\n      if ((newLineRecordCache === null || newLineRecordCache === void 0 ? void 0 : newLineRecordCache.options.recordKey) === eachRecordKey) return;\n      var recordKey = eachRecordKey.toString();\n      // 如果数据在这个 form 中没有展示，也不显示\n      var editRow = get(values, [props.tableName || '', recordKey].flat(1).filter(function (key) {\n        return key || key === 0;\n      }));\n      if (!editRow) return;\n      dataSource = editableRowByKey({\n        data: dataSource,\n        getRowKey: props.getRowKey,\n        row: editRow,\n        key: recordKey,\n        childrenColumnName: props.childrenColumnName || 'children'\n      }, 'update');\n    });\n    var relayValue = value;\n    var recordKey = (_Object$keys$pop = Object.keys(relayValue || {}).pop()) === null || _Object$keys$pop === void 0 ? void 0 : _Object$keys$pop.toString();\n\n    //从form 和 cache 中取得数据\n    var newLineRecordData = _objectSpread(_objectSpread({}, newLineRecordCache === null || newLineRecordCache === void 0 ? void 0 : newLineRecordCache.defaultValue), get(values, [props.tableName || '', recordKey.toString()].flat(1).filter(function (key) {\n      return key || key === 0;\n    })));\n\n    /** 如果已经在 dataSource 中存在了，直接 find */\n    var editRow = dataSourceKeyIndexMapRef.current.has(recordKeyToString(recordKey)) ? dataSource.find(function (item, index) {\n      var _props$getRowKey3;\n      var key = (_props$getRowKey3 = props.getRowKey(item, index)) === null || _props$getRowKey3 === void 0 ? void 0 : _props$getRowKey3.toString();\n      return key === recordKey;\n    }) : newLineRecordData;\n    propsOnValuesChange.run(editRow || newLineRecordData, dataSource);\n  });\n  var saveRefsMap = useRef(new Map());\n  useEffect(function () {\n    // 确保只保留编辑状态的，其它的都删除掉\n    saveRefsMap.current.forEach(function (ref, key) {\n      if (!editableKeysSet.has(key)) {\n        saveRefsMap.current.delete(key);\n      }\n    });\n  }, [saveRefsMap, editableKeysSet]);\n  /**\n   * 保存编辑行\n   *\n   * @param recordKey\n   * @param needReTry\n   */\n  var saveEditable = useRefFunction(/*#__PURE__*/function () {\n    var _ref10 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(recordKey, needReTry) {\n      var relayKey, key, saveRef, _saveRef$current;\n      return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n        while (1) switch (_context7.prev = _context7.next) {\n          case 0:\n            relayKey = recordKeyToString(recordKey);\n            key = dataSourceKeyIndexMapRef.current.get(recordKey.toString());\n            /** 如果没找到key，转化一下再去找 */\n            if (!(!editableKeysSet.has(relayKey) && key && (needReTry !== null && needReTry !== void 0 ? needReTry : true) && props.tableName)) {\n              _context7.next = 6;\n              break;\n            }\n            _context7.next = 5;\n            return saveEditable(key, false);\n          case 5:\n            return _context7.abrupt(\"return\", _context7.sent);\n          case 6:\n            saveRef = saveRefsMap.current.get(relayKey) || saveRefsMap.current.get(relayKey.toString());\n            _context7.prev = 7;\n            _context7.next = 10;\n            return saveRef === null || saveRef === void 0 || (_saveRef$current = saveRef.current) === null || _saveRef$current === void 0 ? void 0 : _saveRef$current.save();\n          case 10:\n            _context7.next = 15;\n            break;\n          case 12:\n            _context7.prev = 12;\n            _context7.t0 = _context7[\"catch\"](7);\n            return _context7.abrupt(\"return\", false);\n          case 15:\n            editableKeysSet.delete(relayKey);\n            editableKeysSet.delete(relayKey.toString());\n            setEditableRowKeys(Array.from(editableKeysSet));\n            return _context7.abrupt(\"return\", true);\n          case 19:\n          case \"end\":\n            return _context7.stop();\n        }\n      }, _callee7, null, [[7, 12]]);\n    }));\n    return function (_x5, _x6) {\n      return _ref10.apply(this, arguments);\n    };\n  }());\n\n  /**\n   * 同时只能支持一行,取消之后数据消息，不会触发 dataSource\n   *\n   * @param row\n   * @param options\n   * @name 增加新的行\n   */\n  var addEditRecord = useRefFunction(function (row, options) {\n    if (options !== null && options !== void 0 && options.parentKey && !dataSourceKeyIndexMapRef.current.has(recordKeyToString(options === null || options === void 0 ? void 0 : options.parentKey).toString())) {\n      console.warn(\"can't find record by key\", options === null || options === void 0 ? void 0 : options.parentKey);\n      return false;\n    }\n    // 暂时不支持多行新增\n    if (newLineRecordRef.current && props.onlyAddOneLineAlertMessage !== false) {\n      warning(props.onlyAddOneLineAlertMessage || intl.getMessage('editableTable.onlyAddOneLine', '只能新增一行'));\n      return false;\n    }\n    // 如果是单行的话，不允许多行编辑\n    if (editableKeysSet.size > 0 && editableType === 'single' && props.onlyOneLineEditorAlertMessage !== false) {\n      warning(props.onlyOneLineEditorAlertMessage || intl.getMessage('editableTable.onlyOneLineEditor', '只能同时编辑一行'));\n      return false;\n    }\n    // 防止多次渲染\n    var recordKey = props.getRowKey(row, -1);\n    if (!recordKey && recordKey !== 0) {\n      noteOnce(!!recordKey, '请设置 recordCreatorProps.record 并返回一个唯一的key  \\n  https://procomponents.ant.design/components/editable-table#editable-%E6%96%B0%E5%BB%BA%E8%A1%8C');\n      throw new Error('请设置 recordCreatorProps.record 并返回一个唯一的key');\n    }\n    editableKeysSet.add(recordKey);\n    setEditableRowKeys(Array.from(editableKeysSet));\n\n    // 如果是dataSource 新增模式的话，取消再开始编辑，\n    // 这样就可以把新增到 dataSource的数据进入编辑模式了\n    // [a,b,cache] => [a,b,c]\n    if ((options === null || options === void 0 ? void 0 : options.newRecordType) === 'dataSource' || props.tableName) {\n      var _recordKeyToString3;\n      var actionProps = {\n        data: props.dataSource,\n        getRowKey: props.getRowKey,\n        row: _objectSpread(_objectSpread({}, row), {}, {\n          map_row_parentKey: options !== null && options !== void 0 && options.parentKey ? (_recordKeyToString3 = recordKeyToString(options === null || options === void 0 ? void 0 : options.parentKey)) === null || _recordKeyToString3 === void 0 ? void 0 : _recordKeyToString3.toString() : undefined\n        }),\n        key: recordKey,\n        childrenColumnName: props.childrenColumnName || 'children'\n      };\n      props.setDataSource(editableRowByKey(actionProps, (options === null || options === void 0 ? void 0 : options.position) === 'top' ? 'top' : 'update'));\n    } else {\n      setNewLineRecordCache({\n        defaultValue: row,\n        options: _objectSpread(_objectSpread({}, options), {}, {\n          recordKey: recordKey\n        })\n      });\n    }\n    return true;\n  });\n  var saveText = (props === null || props === void 0 ? void 0 : props.saveText) || intl.getMessage('editableTable.action.save', '保存');\n  var deleteText = (props === null || props === void 0 ? void 0 : props.deleteText) || intl.getMessage('editableTable.action.delete', '删除');\n  var cancelText = (props === null || props === void 0 ? void 0 : props.cancelText) || intl.getMessage('editableTable.action.cancel', '取消');\n  var actionSaveRef = useRefFunction(/*#__PURE__*/function () {\n    var _ref11 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(recordKey, editRow, originRow, newLine) {\n      var _props$onSave, _recordKeyToString4, _options$parentKey;\n      var res, _ref12, options, actionProps;\n      return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n        while (1) switch (_context8.prev = _context8.next) {\n          case 0:\n            _context8.next = 2;\n            return props === null || props === void 0 || (_props$onSave = props.onSave) === null || _props$onSave === void 0 ? void 0 : _props$onSave.call(props, recordKey, editRow, originRow, newLine);\n          case 2:\n            res = _context8.sent;\n            _context8.next = 5;\n            return cancelEditable(recordKey);\n          case 5:\n            _ref12 = newLine || newLineRecordRef.current || {}, options = _ref12.options;\n            if (!(!(options !== null && options !== void 0 && options.parentKey) && (options === null || options === void 0 ? void 0 : options.recordKey) === recordKey)) {\n              _context8.next = 9;\n              break;\n            }\n            if ((options === null || options === void 0 ? void 0 : options.position) === 'top') {\n              props.setDataSource([editRow].concat(_toConsumableArray(props.dataSource)));\n            } else {\n              props.setDataSource([].concat(_toConsumableArray(props.dataSource), [editRow]));\n            }\n            return _context8.abrupt(\"return\", res);\n          case 9:\n            actionProps = {\n              data: props.dataSource,\n              getRowKey: props.getRowKey,\n              row: options ? _objectSpread(_objectSpread({}, editRow), {}, {\n                map_row_parentKey: (_recordKeyToString4 = recordKeyToString((_options$parentKey = options === null || options === void 0 ? void 0 : options.parentKey) !== null && _options$parentKey !== void 0 ? _options$parentKey : '')) === null || _recordKeyToString4 === void 0 ? void 0 : _recordKeyToString4.toString()\n              }) : editRow,\n              key: recordKey,\n              childrenColumnName: props.childrenColumnName || 'children'\n            };\n            props.setDataSource(editableRowByKey(actionProps, (options === null || options === void 0 ? void 0 : options.position) === 'top' ? 'top' : 'update'));\n            _context8.next = 13;\n            return cancelEditable(recordKey);\n          case 13:\n            return _context8.abrupt(\"return\", res);\n          case 14:\n          case \"end\":\n            return _context8.stop();\n        }\n      }, _callee8);\n    }));\n    return function (_x7, _x8, _x9, _x10) {\n      return _ref11.apply(this, arguments);\n    };\n  }());\n  var actionDeleteRef = useRefFunction(/*#__PURE__*/function () {\n    var _ref13 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(recordKey, editRow) {\n      var _props$onDelete2;\n      var actionProps, res;\n      return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n        while (1) switch (_context9.prev = _context9.next) {\n          case 0:\n            actionProps = {\n              data: props.dataSource,\n              getRowKey: props.getRowKey,\n              row: editRow,\n              key: recordKey,\n              childrenColumnName: props.childrenColumnName || 'children'\n            };\n            _context9.next = 3;\n            return props === null || props === void 0 || (_props$onDelete2 = props.onDelete) === null || _props$onDelete2 === void 0 ? void 0 : _props$onDelete2.call(props, recordKey, editRow);\n          case 3:\n            res = _context9.sent;\n            _context9.next = 6;\n            return cancelEditable(recordKey, false);\n          case 6:\n            props.setDataSource(editableRowByKey(actionProps, 'delete'));\n            return _context9.abrupt(\"return\", res);\n          case 8:\n          case \"end\":\n            return _context9.stop();\n        }\n      }, _callee9);\n    }));\n    return function (_x11, _x12) {\n      return _ref13.apply(this, arguments);\n    };\n  }());\n  var actionCancelRef = useRefFunction(/*#__PURE__*/function () {\n    var _ref14 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee10(recordKey, editRow, originRow, newLine) {\n      var _props$onCancel;\n      var res;\n      return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n        while (1) switch (_context10.prev = _context10.next) {\n          case 0:\n            _context10.next = 2;\n            return props === null || props === void 0 || (_props$onCancel = props.onCancel) === null || _props$onCancel === void 0 ? void 0 : _props$onCancel.call(props, recordKey, editRow, originRow, newLine);\n          case 2:\n            res = _context10.sent;\n            return _context10.abrupt(\"return\", res);\n          case 4:\n          case \"end\":\n            return _context10.stop();\n        }\n      }, _callee10);\n    }));\n    return function (_x13, _x14, _x15, _x16) {\n      return _ref14.apply(this, arguments);\n    };\n  }());\n\n  // 如果传入了自定义的actionRender，使用useRefFunction以确保内部的事件处理函数可以访问最新的state\n  var existCustomActionRender = props.actionRender && typeof props.actionRender === 'function';\n  var customActionRender = existCustomActionRender ? props.actionRender : function () {};\n  var customActionRenderRef = useRefFunction(customActionRender);\n  var actionRender = function actionRender(row) {\n    var key = props.getRowKey(row, row.index);\n    var config = {\n      saveText: saveText,\n      cancelText: cancelText,\n      deleteText: deleteText,\n      addEditRecord: addEditRecord,\n      recordKey: key,\n      cancelEditable: cancelEditable,\n      index: row.index,\n      tableName: props.tableName,\n      newLineConfig: newLineRecordCache,\n      onCancel: actionCancelRef,\n      onDelete: actionDeleteRef,\n      onSave: actionSaveRef,\n      editableKeys: editableKeys,\n      setEditableRowKeys: setEditableRowKeys,\n      preEditRowRef: preEditRowRef,\n      deletePopconfirmMessage: props.deletePopconfirmMessage || \"\".concat(intl.getMessage('deleteThisLine', '删除此项'), \"?\")\n    };\n    var renderResult = defaultActionRender(row, config);\n    // 缓存一下saveRef\n    if (props.tableName) {\n      saveRefsMap.current.set(dataSourceKeyIndexMapRef.current.get(recordKeyToString(key)) || recordKeyToString(key), renderResult.saveRef);\n    } else {\n      saveRefsMap.current.set(recordKeyToString(key), renderResult.saveRef);\n    }\n    if (existCustomActionRender) return customActionRenderRef(row, config, {\n      save: renderResult.save,\n      delete: renderResult.delete,\n      cancel: renderResult.cancel\n    });\n    return [renderResult.save, renderResult.delete, renderResult.cancel];\n  };\n  return {\n    editableKeys: editableKeys,\n    setEditableRowKeys: setEditableRowKeys,\n    isEditable: isEditable,\n    actionRender: actionRender,\n    startEditable: startEditable,\n    cancelEditable: cancelEditable,\n    addEditRecord: addEditRecord,\n    saveEditable: saveEditable,\n    newLineRecord: newLineRecordCache,\n    preEditableKeys: editableKeysRef,\n    onValuesChange: onValuesChange,\n    getRealIndex: props.getRealIndex\n  };\n}","map":{"version":3,"names":["_toConsumableArray","_regeneratorRuntime","_toArray","_asyncToGenerator","_slicedToArray","_defineProperty","_objectWithoutProperties","_objectSpread","_typeof","_excluded","_excluded2","_excluded3","LoadingOutlined","useIntl","Form","Popconfirm","message","useLazyKVMap","useMergedState","get","set","noteOnce","React","createRef","forwardRef","useContext","useEffect","useImperativeHandle","useMemo","useRef","useState","useDebounceFn","useRefFunction","ProFormContext","useDeepCompareEffectDebounce","usePrevious","merge","useMountMergeState","jsx","_jsx","jsxs","_jsxs","warning","messageStr","warn","recordKeyToString","rowKey","Array","isArray","join","editableRowByKey","keyProps","action","_recordKeyToString","getRowKey","row","data","_keyProps$childrenCol","childrenColumnName","key","toString","kvMap","Map","dig","records","map_row_parentKey","map_row_index","forEach","record","index","eachIndex","recordKey","newRecord","map_row_key","children","undefined","delete","fill","map","kvArrayMap","kvSource","fillNewRecord","fillChildren","arguments","length","value","rest","has","_kvArrayMap$get","push","_kvArrayMap$get2","item","SaveEditableAction","_ref","ref","onSave","newLineConfig","editorType","tableName","context","form","useFormInstance","_useMountMergeState","_useMountMergeState2","loading","setLoading","save","mark","_callee","_context$getFieldForm","isMapEditor","namePath","fields","_recordKey","recordKeyPath","curValue","res","wrap","_callee$","_context","prev","next","flat","filter","Boolean","validateFields","recursive","getFieldFormatValue","call","getFieldValue","slice","sent","abrupt","t0","console","log","stop","onClick","_ref3","_callee2","e","_callee2$","_context2","stopPropagation","preventDefault","_x","apply","style","marginInlineEnd","DeleteEditableAction","_ref4","onDelete","preEditRowRef","deletePopconfirmMessage","_useMountMergeState3","_useMountMergeState4","_onConfirm","_callee3","_callee3$","_context3","current","finish","title","onConfirm","CancelEditableAction","props","onCancel","cancelEditable","cancelText","_ref6","_callee4","_context$getFieldForm2","_props$onDelete","_callee4$","_context4","setFieldsValue","_x2","defaultActionRender","config","saveText","deleteText","SaveEditableActionRef","saveRef","options","cancel","useEditableArray","intl","_useState","_useState2","newLineRecordCache","setNewLineRecordCache","resetMapRef","loopGetKey","dataSource","parentKey","_recordKeyToString2","initDataSourceKeyIndexMap","dataSourceKeyIndexMapRef","newLineRecordRef","editableType","type","_useLazyKVMap","_useLazyKVMap2","getRecordByKey","_useMergedState","editableKeys","onChange","keys","_props$onChange","_keys$filter","_keys$map$filter","_useMergedState2","setEditableRowKeys","editableKeysSet","Set","editableKeysRef","isEditable","_props$getRowKey","_props$getRowKey$toSt","_props$getRowKey2","_props$getRowKey2$toS","recordKeyOrIndex","stringEditableKeys","stringEditableKeysRef","preIsEditable","includes","startEditable","_ref7","_props$dataSource","size","onlyOneLineEditorAlertMessage","getMessage","add","from","find","recordData","_ref8","_callee5","needReTry","relayKey","_callee5$","_context5","_x3","_x4","propsOnValuesChange","_callee6","_props$onValuesChange","_len","_key","_args6","_callee6$","_context6","onValuesChange","concat","values","_Object$keys$pop","eachRecordKey","editRow","relayValue","Object","pop","newLineRecordData","defaultValue","_props$getRowKey3","run","saveRefsMap","saveEditable","_ref10","_callee7","_saveRef$current","_callee7$","_context7","_x5","_x6","addEditRecord","onlyAddOneLineAlertMessage","Error","newRecordType","_recordKeyToString3","actionProps","setDataSource","position","actionSaveRef","_ref11","_callee8","originRow","newLine","_props$onSave","_recordKeyToString4","_options$parentKey","_ref12","_callee8$","_context8","_x7","_x8","_x9","_x10","actionDeleteRef","_ref13","_callee9","_props$onDelete2","_callee9$","_context9","_x11","_x12","actionCancelRef","_ref14","_callee10","_props$onCancel","_callee10$","_context10","_x13","_x14","_x15","_x16","existCustomActionRender","actionRender","customActionRender","customActionRenderRef","renderResult","newLineRecord","preEditableKeys","getRealIndex"],"sources":["/Users/phanluc/admin-web-fe/node_modules/@ant-design/pro-utils/es/useEditableArray/index.js"],"sourcesContent":["import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/esm/regeneratorRuntime\";\nimport _toArray from \"@babel/runtime/helpers/esm/toArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nvar _excluded = [\"map_row_parentKey\"],\n  _excluded2 = [\"map_row_parentKey\", \"map_row_key\"],\n  _excluded3 = [\"map_row_key\"];\n/* eslint-disable react-hooks/exhaustive-deps */\nimport { LoadingOutlined } from '@ant-design/icons';\nimport { useIntl } from '@ant-design/pro-provider';\nimport { Form, Popconfirm, message } from 'antd';\nimport useLazyKVMap from \"antd/es/table/hooks/useLazyKVMap\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport get from \"rc-util/es/utils/get\";\nimport set from \"rc-util/es/utils/set\";\nimport { noteOnce } from \"rc-util/es/warning\";\nimport React, { createRef, forwardRef, useContext, useEffect, useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport { useDebounceFn, useRefFunction } from '..';\nimport { ProFormContext } from \"../components/ProFormContext\";\nimport { useDeepCompareEffectDebounce } from \"../hooks/useDeepCompareEffect\";\nimport { usePrevious } from \"../hooks/usePrevious\";\nimport { merge } from \"../merge\";\nimport { useMountMergeState } from \"../useMountMergeState\";\n\n/**\n * 兼容antd@4 和 antd@5 的warning\n * @param messageStr\n */\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar warning = function warning(messageStr) {\n  // @ts-ignore\n  return (message.warn || message.warning)(messageStr);\n};\nexport var recordKeyToString = function recordKeyToString(rowKey) {\n  if (Array.isArray(rowKey)) return rowKey.join(',');\n  return rowKey;\n};\n/**\n * 使用map 来删除数据，性能一般 但是准确率比较高\n *\n * @param keyProps\n * @param action\n */\nexport function editableRowByKey(keyProps, action) {\n  var _recordKeyToString;\n  var getRowKey = keyProps.getRowKey,\n    row = keyProps.row,\n    data = keyProps.data,\n    _keyProps$childrenCol = keyProps.childrenColumnName,\n    childrenColumnName = _keyProps$childrenCol === void 0 ? 'children' : _keyProps$childrenCol;\n  var key = (_recordKeyToString = recordKeyToString(keyProps.key)) === null || _recordKeyToString === void 0 ? void 0 : _recordKeyToString.toString();\n  var kvMap = new Map();\n\n  /**\n   * 打平这个数组\n   *\n   * @param records\n   * @param parentKey\n   */\n  function dig(records, map_row_parentKey, map_row_index) {\n    records.forEach(function (record, index) {\n      var eachIndex = (map_row_index || 0) * 10 + index;\n      var recordKey = getRowKey(record, eachIndex).toString();\n      // children 取在前面方便拼的时候按照反顺序放回去\n      if (record && _typeof(record) === 'object' && childrenColumnName in record) {\n        dig(record[childrenColumnName] || [], recordKey, eachIndex);\n      }\n      var newRecord = _objectSpread(_objectSpread({}, record), {}, {\n        map_row_key: recordKey,\n        children: undefined,\n        map_row_parentKey: map_row_parentKey\n      });\n      delete newRecord.children;\n      if (!map_row_parentKey) {\n        delete newRecord.map_row_parentKey;\n      }\n      kvMap.set(recordKey, newRecord);\n    });\n  }\n  if (action === 'top') {\n    kvMap.set(key, _objectSpread(_objectSpread({}, kvMap.get(key)), row));\n  }\n  dig(data);\n  if (action === 'update') {\n    kvMap.set(key, _objectSpread(_objectSpread({}, kvMap.get(key)), row));\n  }\n  if (action === 'delete') {\n    kvMap.delete(key);\n  }\n  var fill = function fill(map) {\n    var kvArrayMap = new Map();\n    var kvSource = [];\n    var fillNewRecord = function fillNewRecord() {\n      var fillChildren = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      map.forEach(function (value) {\n        if (value.map_row_parentKey && !value.map_row_key) {\n          var map_row_parentKey = value.map_row_parentKey,\n            rest = _objectWithoutProperties(value, _excluded);\n          if (!kvArrayMap.has(map_row_parentKey)) {\n            kvArrayMap.set(map_row_parentKey, []);\n          }\n          if (fillChildren) {\n            var _kvArrayMap$get;\n            (_kvArrayMap$get = kvArrayMap.get(map_row_parentKey)) === null || _kvArrayMap$get === void 0 || _kvArrayMap$get.push(rest);\n          }\n        }\n      });\n    };\n    fillNewRecord(action === 'top');\n    map.forEach(function (value) {\n      if (value.map_row_parentKey && value.map_row_key) {\n        var _kvArrayMap$get2;\n        var map_row_parentKey = value.map_row_parentKey,\n          map_row_key = value.map_row_key,\n          rest = _objectWithoutProperties(value, _excluded2);\n        if (kvArrayMap.has(map_row_key)) {\n          rest[childrenColumnName] = kvArrayMap.get(map_row_key);\n        }\n        if (!kvArrayMap.has(map_row_parentKey)) {\n          kvArrayMap.set(map_row_parentKey, []);\n        }\n        (_kvArrayMap$get2 = kvArrayMap.get(map_row_parentKey)) === null || _kvArrayMap$get2 === void 0 || _kvArrayMap$get2.push(rest);\n      }\n    });\n    fillNewRecord(action === 'update');\n    map.forEach(function (value) {\n      if (!value.map_row_parentKey) {\n        var map_row_key = value.map_row_key,\n          rest = _objectWithoutProperties(value, _excluded3);\n        if (map_row_key && kvArrayMap.has(map_row_key)) {\n          var item = _objectSpread(_objectSpread({}, rest), {}, _defineProperty({}, childrenColumnName, kvArrayMap.get(map_row_key)));\n          kvSource.push(item);\n          return;\n        }\n        kvSource.push(rest);\n      }\n    });\n    return kvSource;\n  };\n  return fill(kvMap);\n}\n\n/**\n * 保存按钮的dom\n *\n * @param ActionRenderConfig\n */\nexport function SaveEditableAction(_ref, ref) {\n  var recordKey = _ref.recordKey,\n    onSave = _ref.onSave,\n    row = _ref.row,\n    children = _ref.children,\n    newLineConfig = _ref.newLineConfig,\n    editorType = _ref.editorType,\n    tableName = _ref.tableName;\n  var context = useContext(ProFormContext);\n  var form = Form.useFormInstance();\n  var _useMountMergeState = useMountMergeState(false),\n    _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n    loading = _useMountMergeState2[0],\n    setLoading = _useMountMergeState2[1];\n  var save = useRefFunction( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n    var _context$getFieldForm, isMapEditor, namePath, fields, _recordKey, recordKeyPath, curValue, data, res;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          isMapEditor = editorType === 'Map'; // 为了兼容类型为 array 的 dataIndex,当 recordKey 是一个数组时，用于获取表单值的 key 只取第一项，\n          // 从表单中获取回来之后，再根据 namepath 获取具体的某个字段并设置\n          namePath = [tableName, Array.isArray(recordKey) ? recordKey[0] : recordKey].map(function (key) {\n            return key === null || key === void 0 ? void 0 : key.toString();\n          }).flat(1).filter(Boolean);\n          setLoading(true);\n          _context.next = 6;\n          return form.validateFields(namePath, {\n            recursive: true\n          });\n        case 6:\n          fields = (context === null || context === void 0 || (_context$getFieldForm = context.getFieldFormatValue) === null || _context$getFieldForm === void 0 ? void 0 : _context$getFieldForm.call(context, namePath)) || form.getFieldValue(namePath); // 处理 dataIndex 为数组的情况\n          if (Array.isArray(recordKey) && recordKey.length > 1) {\n            // 获取 namepath\n            _recordKey = _toArray(recordKey), recordKeyPath = _recordKey.slice(1); // 将目标值获取出来并设置到 fields 当中\n            curValue = get(fields, recordKeyPath);\n            set(fields, recordKeyPath, curValue);\n          }\n          data = isMapEditor ? set({}, namePath, fields) : fields; // 获取数据并保存\n          _context.next = 11;\n          return onSave === null || onSave === void 0 ? void 0 : onSave(recordKey,\n          // 如果是 map 模式，fields 就是一个值，所以需要set 到对象中\n          // 数据模式 fields 是一个对象，所以不需要\n          merge({}, row, data), row, newLineConfig);\n        case 11:\n          res = _context.sent;\n          setLoading(false);\n          return _context.abrupt(\"return\", res);\n        case 16:\n          _context.prev = 16;\n          _context.t0 = _context[\"catch\"](0);\n          // eslint-disable-next-line no-console\n          console.log(_context.t0);\n          setLoading(false);\n          throw _context.t0;\n        case 21:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee, null, [[0, 16]]);\n  })));\n\n  // 保存数据\n  useImperativeHandle(ref, function () {\n    return {\n      save: save\n    };\n  }, [save]);\n  return /*#__PURE__*/_jsxs(\"a\", {\n    onClick: ( /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e) {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              e.stopPropagation();\n              e.preventDefault();\n              _context2.prev = 2;\n              _context2.next = 5;\n              return save();\n            case 5:\n              _context2.next = 9;\n              break;\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](2);\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[2, 7]]);\n      }));\n      return function (_x) {\n        return _ref3.apply(this, arguments);\n      };\n    }()),\n    children: [loading ? /*#__PURE__*/_jsx(LoadingOutlined, {\n      style: {\n        marginInlineEnd: 8\n      }\n    }) : null, children || '保存']\n  }, \"save\");\n}\n/**\n * 删除按钮 dom\n *\n * @param ActionRenderConfig\n */\nexport var DeleteEditableAction = function DeleteEditableAction(_ref4) {\n  var recordKey = _ref4.recordKey,\n    onDelete = _ref4.onDelete,\n    preEditRowRef = _ref4.preEditRowRef,\n    row = _ref4.row,\n    children = _ref4.children,\n    deletePopconfirmMessage = _ref4.deletePopconfirmMessage;\n  var _useMountMergeState3 = useMountMergeState(function () {\n      return false;\n    }),\n    _useMountMergeState4 = _slicedToArray(_useMountMergeState3, 2),\n    loading = _useMountMergeState4[0],\n    setLoading = _useMountMergeState4[1];\n  var _onConfirm = useRefFunction( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n    var res;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          setLoading(true);\n          _context3.next = 4;\n          return onDelete === null || onDelete === void 0 ? void 0 : onDelete(recordKey, row);\n        case 4:\n          res = _context3.sent;\n          setLoading(false);\n          return _context3.abrupt(\"return\", res);\n        case 9:\n          _context3.prev = 9;\n          _context3.t0 = _context3[\"catch\"](0);\n          // eslint-disable-next-line no-console\n          console.log(_context3.t0);\n          setLoading(false);\n          return _context3.abrupt(\"return\", null);\n        case 14:\n          _context3.prev = 14;\n          if (preEditRowRef) preEditRowRef.current = null;\n          return _context3.finish(14);\n        case 17:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3, null, [[0, 9, 14, 17]]);\n  })));\n  return children !== false ? /*#__PURE__*/_jsx(Popconfirm, {\n    title: deletePopconfirmMessage,\n    onConfirm: function onConfirm() {\n      return _onConfirm();\n    },\n    children: /*#__PURE__*/_jsxs(\"a\", {\n      children: [loading ? /*#__PURE__*/_jsx(LoadingOutlined, {\n        style: {\n          marginInlineEnd: 8\n        }\n      }) : null, children || '删除']\n    })\n  }, \"delete\") : null;\n};\nvar CancelEditableAction = function CancelEditableAction(props) {\n  var recordKey = props.recordKey,\n    tableName = props.tableName,\n    newLineConfig = props.newLineConfig,\n    editorType = props.editorType,\n    onCancel = props.onCancel,\n    cancelEditable = props.cancelEditable,\n    row = props.row,\n    cancelText = props.cancelText,\n    preEditRowRef = props.preEditRowRef;\n  var context = useContext(ProFormContext);\n  var form = Form.useFormInstance();\n  return /*#__PURE__*/_jsx(\"a\", {\n    onClick: ( /*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(e) {\n        var _context$getFieldForm2;\n        var isMapEditor, namePath, fields, record, res, _props$onDelete;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              e.stopPropagation();\n              e.preventDefault();\n              isMapEditor = editorType === 'Map';\n              namePath = [tableName, recordKey].flat(1).filter(Boolean);\n              fields = (context === null || context === void 0 || (_context$getFieldForm2 = context.getFieldFormatValue) === null || _context$getFieldForm2 === void 0 ? void 0 : _context$getFieldForm2.call(context, namePath)) || (form === null || form === void 0 ? void 0 : form.getFieldValue(namePath));\n              record = isMapEditor ? set({}, namePath, fields) : fields;\n              _context4.next = 8;\n              return onCancel === null || onCancel === void 0 ? void 0 : onCancel(recordKey, record, row, newLineConfig);\n            case 8:\n              res = _context4.sent;\n              _context4.next = 11;\n              return cancelEditable(recordKey);\n            case 11:\n              if (!((preEditRowRef === null || preEditRowRef === void 0 ? void 0 : preEditRowRef.current) !== null)) {\n                _context4.next = 15;\n                break;\n              }\n              form.setFieldsValue(set({}, namePath, preEditRowRef === null || preEditRowRef === void 0 ? void 0 : preEditRowRef.current));\n              _context4.next = 17;\n              break;\n            case 15:\n              _context4.next = 17;\n              return (_props$onDelete = props.onDelete) === null || _props$onDelete === void 0 ? void 0 : _props$onDelete.call(props, recordKey, row);\n            case 17:\n              if (preEditRowRef) preEditRowRef.current = null;\n              return _context4.abrupt(\"return\", res);\n            case 19:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4);\n      }));\n      return function (_x2) {\n        return _ref6.apply(this, arguments);\n      };\n    }()),\n    children: cancelText || '取消'\n  }, \"cancel\");\n};\nexport function defaultActionRender(row, config) {\n  var recordKey = config.recordKey,\n    newLineConfig = config.newLineConfig,\n    saveText = config.saveText,\n    deleteText = config.deleteText;\n  var SaveEditableActionRef = /*#__PURE__*/forwardRef(SaveEditableAction);\n  var saveRef = /*#__PURE__*/createRef();\n  return {\n    save: /*#__PURE__*/_jsx(SaveEditableActionRef, _objectSpread(_objectSpread({}, config), {}, {\n      row: row,\n      ref: saveRef,\n      children: saveText\n    }), 'save' + recordKey),\n    saveRef: saveRef,\n    delete: (newLineConfig === null || newLineConfig === void 0 ? void 0 : newLineConfig.options.recordKey) !== recordKey ? /*#__PURE__*/_jsx(DeleteEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n      row: row,\n      children: deleteText\n    }), 'delete' + recordKey) : undefined,\n    cancel: /*#__PURE__*/_jsx(CancelEditableAction, _objectSpread(_objectSpread({}, config), {}, {\n      row: row\n    }), 'cancel' + recordKey)\n  };\n}\n\n/**\n * 一个方便的hooks 用于维护编辑的状态\n *\n * @param props\n */\nexport function useEditableArray(props) {\n  // Internationalization\n  var intl = useIntl();\n\n  /**\n   * 点击开始编辑之前的保存数据用的\n   */\n  var preEditRowRef = useRef(null);\n  var _useState = useState(undefined),\n    _useState2 = _slicedToArray(_useState, 2),\n    newLineRecordCache = _useState2[0],\n    setNewLineRecordCache = _useState2[1];\n  var resetMapRef = function resetMapRef() {\n    var map = new Map();\n    //存在children时会覆盖Map的key,导致使用数组索引查找key错误\n    var loopGetKey = function loopGetKey(dataSource, parentKey) {\n      dataSource === null || dataSource === void 0 || dataSource.forEach(function (record, index) {\n        var _recordKeyToString2;\n        var key = parentKey === undefined || parentKey === null ? index.toString() : parentKey + '_' + index.toString();\n        map.set(key, recordKeyToString(props.getRowKey(record, -1)));\n        map.set((_recordKeyToString2 = recordKeyToString(props.getRowKey(record, -1))) === null || _recordKeyToString2 === void 0 ? void 0 : _recordKeyToString2.toString(), key);\n        if (props.childrenColumnName && record !== null && record !== void 0 && record[props.childrenColumnName]) {\n          loopGetKey(record[props.childrenColumnName], key);\n        }\n      });\n    };\n    loopGetKey(props.dataSource);\n    return map;\n  };\n  var initDataSourceKeyIndexMap = useMemo(function () {\n    return resetMapRef();\n  }, []);\n  var dataSourceKeyIndexMapRef = useRef(initDataSourceKeyIndexMap);\n  var newLineRecordRef = useRef(undefined);\n  useDeepCompareEffectDebounce(function () {\n    dataSourceKeyIndexMapRef.current = resetMapRef();\n  }, [props.dataSource]);\n\n  // 这里这么做是为了存上次的状态，不然每次存一下再拿\n  newLineRecordRef.current = newLineRecordCache;\n  var editableType = props.type || 'single';\n  var _useLazyKVMap = useLazyKVMap(props.dataSource, 'children', props.getRowKey),\n    _useLazyKVMap2 = _slicedToArray(_useLazyKVMap, 1),\n    getRecordByKey = _useLazyKVMap2[0];\n  var _useMergedState = useMergedState([], {\n      value: props.editableKeys,\n      onChange: props.onChange ? function (keys) {\n        var _props$onChange, _keys$filter, _keys$map$filter;\n        props === null || props === void 0 || (_props$onChange = props.onChange) === null || _props$onChange === void 0 || _props$onChange.call(props, // 计算编辑的key\n        (_keys$filter = keys === null || keys === void 0 ? void 0 : keys.filter(function (key) {\n          return key !== undefined;\n        })) !== null && _keys$filter !== void 0 ? _keys$filter : [], // 计算编辑的行\n        (_keys$map$filter = keys === null || keys === void 0 ? void 0 : keys.map(function (key) {\n          return getRecordByKey(key);\n        }).filter(function (key) {\n          return key !== undefined;\n        })) !== null && _keys$map$filter !== void 0 ? _keys$map$filter : []);\n      } : undefined\n    }),\n    _useMergedState2 = _slicedToArray(_useMergedState, 2),\n    editableKeys = _useMergedState2[0],\n    setEditableRowKeys = _useMergedState2[1];\n\n  /** 一个用来标志的set 提供了方便的 api 来去重什么的 */\n  var editableKeysSet = useMemo(function () {\n    var keys = editableType === 'single' ? editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.slice(0, 1) : editableKeys;\n    return new Set(keys);\n  }, [(editableKeys || []).join(','), editableType]);\n  var editableKeysRef = usePrevious(editableKeys);\n\n  /** 这行是不是编辑状态 */\n  var isEditable = useRefFunction(function (row) {\n    var _props$getRowKey, _props$getRowKey$toSt, _props$getRowKey2, _props$getRowKey2$toS;\n    // 为了兼容一下name 模式的 indexKey，所以需要判断两次，一次是index，一次是没有 index 的\n    var recordKeyOrIndex = (_props$getRowKey = props.getRowKey(row, row.index)) === null || _props$getRowKey === void 0 || (_props$getRowKey$toSt = _props$getRowKey.toString) === null || _props$getRowKey$toSt === void 0 ? void 0 : _props$getRowKey$toSt.call(_props$getRowKey);\n    // 这里是不设置 index 的地方\n    var recordKey = (_props$getRowKey2 = props.getRowKey(row, -1)) === null || _props$getRowKey2 === void 0 || (_props$getRowKey2$toS = _props$getRowKey2.toString) === null || _props$getRowKey2$toS === void 0 ? void 0 : _props$getRowKey2$toS.call(_props$getRowKey2);\n\n    // 都转化为了字符串，不然 number 和 string\n    var stringEditableKeys = editableKeys === null || editableKeys === void 0 ? void 0 : editableKeys.map(function (key) {\n      return key === null || key === void 0 ? void 0 : key.toString();\n    });\n    var stringEditableKeysRef = (editableKeysRef === null || editableKeysRef === void 0 ? void 0 : editableKeysRef.map(function (key) {\n      return key === null || key === void 0 ? void 0 : key.toString();\n    })) || [];\n    var preIsEditable = props.tableName && !!(stringEditableKeysRef !== null && stringEditableKeysRef !== void 0 && stringEditableKeysRef.includes(recordKey)) || !!(stringEditableKeysRef !== null && stringEditableKeysRef !== void 0 && stringEditableKeysRef.includes(recordKeyOrIndex));\n    return {\n      recordKey: recordKey,\n      isEditable: props.tableName && (stringEditableKeys === null || stringEditableKeys === void 0 ? void 0 : stringEditableKeys.includes(recordKey)) || (stringEditableKeys === null || stringEditableKeys === void 0 ? void 0 : stringEditableKeys.includes(recordKeyOrIndex)),\n      preIsEditable: preIsEditable\n    };\n  });\n\n  /**\n   * 进入编辑状态\n   *\n   * @param recordKey\n   */\n  var startEditable = useRefFunction(function (recordKey, record) {\n    var _ref7, _props$dataSource;\n    // 如果是单行的话，不允许多行编辑\n    if (editableKeysSet.size > 0 && editableType === 'single' && props.onlyOneLineEditorAlertMessage !== false) {\n      warning(props.onlyOneLineEditorAlertMessage || intl.getMessage('editableTable.onlyOneLineEditor', '只能同时编辑一行'));\n      return false;\n    }\n    editableKeysSet.add(recordKey);\n    setEditableRowKeys(Array.from(editableKeysSet));\n\n    // 这里是为了存上次的状态,不然取消的时候就丢掉了\n    preEditRowRef.current = (_ref7 = record !== null && record !== void 0 ? record : (_props$dataSource = props.dataSource) === null || _props$dataSource === void 0 ? void 0 : _props$dataSource.find(function (recordData, index) {\n      return props.getRowKey(recordData, index) === recordKey;\n    })) !== null && _ref7 !== void 0 ? _ref7 : null;\n    return true;\n  });\n\n  /**\n   * 退出编辑状态\n   *\n   * @param recordKey\n   */\n  var cancelEditable = useRefFunction( /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(recordKey, needReTry) {\n      var relayKey, key;\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) switch (_context5.prev = _context5.next) {\n          case 0:\n            relayKey = recordKeyToString(recordKey).toString();\n            key = dataSourceKeyIndexMapRef.current.get(relayKey);\n            /** 如果没找到key，转化一下再去找 */\n            if (!(!editableKeysSet.has(relayKey) && key && (needReTry !== null && needReTry !== void 0 ? needReTry : true) && props.tableName)) {\n              _context5.next = 5;\n              break;\n            }\n            cancelEditable(key, false);\n            return _context5.abrupt(\"return\");\n          case 5:\n            /** 如果这个是 new Line 直接删除 */\n            if (newLineRecordCache && newLineRecordCache.options.recordKey === recordKey) {\n              setNewLineRecordCache(undefined);\n            }\n            editableKeysSet.delete(relayKey);\n            editableKeysSet.delete(recordKeyToString(recordKey));\n            setEditableRowKeys(Array.from(editableKeysSet));\n            return _context5.abrupt(\"return\", true);\n          case 10:\n          case \"end\":\n            return _context5.stop();\n        }\n      }, _callee5);\n    }));\n    return function (_x3, _x4) {\n      return _ref8.apply(this, arguments);\n    };\n  }());\n  var propsOnValuesChange = useDebounceFn( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n    var _props$onValuesChange;\n    var _len,\n      rest,\n      _key,\n      _args6 = arguments;\n    return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n      while (1) switch (_context6.prev = _context6.next) {\n        case 0:\n          for (_len = _args6.length, rest = new Array(_len), _key = 0; _key < _len; _key++) {\n            rest[_key] = _args6[_key];\n          }\n          //@ts-ignore\n          (_props$onValuesChange = props.onValuesChange) === null || _props$onValuesChange === void 0 || _props$onValuesChange.call.apply(_props$onValuesChange, [props].concat(rest));\n        case 2:\n        case \"end\":\n          return _context6.stop();\n      }\n    }, _callee6);\n  })), 64);\n  var onValuesChange = useRefFunction(function (value, values) {\n    var _Object$keys$pop;\n    if (!props.onValuesChange) {\n      return;\n    }\n    var dataSource = props.dataSource;\n\n    // 这里是把正在编辑中的所有表单数据都修改掉\n    // 不然会用 props 里面的 dataSource，数据只有正在编辑中的\n    // Object.keys(get(values, [props.tableName || ''].flat(1)) || values).forEach((recordKey) => {\n    editableKeys === null || editableKeys === void 0 || editableKeys.forEach(function (eachRecordKey) {\n      if ((newLineRecordCache === null || newLineRecordCache === void 0 ? void 0 : newLineRecordCache.options.recordKey) === eachRecordKey) return;\n      var recordKey = eachRecordKey.toString();\n      // 如果数据在这个 form 中没有展示，也不显示\n      var editRow = get(values, [props.tableName || '', recordKey].flat(1).filter(function (key) {\n        return key || key === 0;\n      }));\n      if (!editRow) return;\n      dataSource = editableRowByKey({\n        data: dataSource,\n        getRowKey: props.getRowKey,\n        row: editRow,\n        key: recordKey,\n        childrenColumnName: props.childrenColumnName || 'children'\n      }, 'update');\n    });\n    var relayValue = value;\n    var recordKey = (_Object$keys$pop = Object.keys(relayValue || {}).pop()) === null || _Object$keys$pop === void 0 ? void 0 : _Object$keys$pop.toString();\n\n    //从form 和 cache 中取得数据\n    var newLineRecordData = _objectSpread(_objectSpread({}, newLineRecordCache === null || newLineRecordCache === void 0 ? void 0 : newLineRecordCache.defaultValue), get(values, [props.tableName || '', recordKey.toString()].flat(1).filter(function (key) {\n      return key || key === 0;\n    })));\n\n    /** 如果已经在 dataSource 中存在了，直接 find */\n    var editRow = dataSourceKeyIndexMapRef.current.has(recordKeyToString(recordKey)) ? dataSource.find(function (item, index) {\n      var _props$getRowKey3;\n      var key = (_props$getRowKey3 = props.getRowKey(item, index)) === null || _props$getRowKey3 === void 0 ? void 0 : _props$getRowKey3.toString();\n      return key === recordKey;\n    }) : newLineRecordData;\n    propsOnValuesChange.run(editRow || newLineRecordData, dataSource);\n  });\n  var saveRefsMap = useRef(new Map());\n  useEffect(function () {\n    // 确保只保留编辑状态的，其它的都删除掉\n    saveRefsMap.current.forEach(function (ref, key) {\n      if (!editableKeysSet.has(key)) {\n        saveRefsMap.current.delete(key);\n      }\n    });\n  }, [saveRefsMap, editableKeysSet]);\n  /**\n   * 保存编辑行\n   *\n   * @param recordKey\n   * @param needReTry\n   */\n  var saveEditable = useRefFunction( /*#__PURE__*/function () {\n    var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(recordKey, needReTry) {\n      var relayKey, key, saveRef, _saveRef$current;\n      return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n        while (1) switch (_context7.prev = _context7.next) {\n          case 0:\n            relayKey = recordKeyToString(recordKey);\n            key = dataSourceKeyIndexMapRef.current.get(recordKey.toString());\n            /** 如果没找到key，转化一下再去找 */\n            if (!(!editableKeysSet.has(relayKey) && key && (needReTry !== null && needReTry !== void 0 ? needReTry : true) && props.tableName)) {\n              _context7.next = 6;\n              break;\n            }\n            _context7.next = 5;\n            return saveEditable(key, false);\n          case 5:\n            return _context7.abrupt(\"return\", _context7.sent);\n          case 6:\n            saveRef = saveRefsMap.current.get(relayKey) || saveRefsMap.current.get(relayKey.toString());\n            _context7.prev = 7;\n            _context7.next = 10;\n            return saveRef === null || saveRef === void 0 || (_saveRef$current = saveRef.current) === null || _saveRef$current === void 0 ? void 0 : _saveRef$current.save();\n          case 10:\n            _context7.next = 15;\n            break;\n          case 12:\n            _context7.prev = 12;\n            _context7.t0 = _context7[\"catch\"](7);\n            return _context7.abrupt(\"return\", false);\n          case 15:\n            editableKeysSet.delete(relayKey);\n            editableKeysSet.delete(relayKey.toString());\n            setEditableRowKeys(Array.from(editableKeysSet));\n            return _context7.abrupt(\"return\", true);\n          case 19:\n          case \"end\":\n            return _context7.stop();\n        }\n      }, _callee7, null, [[7, 12]]);\n    }));\n    return function (_x5, _x6) {\n      return _ref10.apply(this, arguments);\n    };\n  }());\n\n  /**\n   * 同时只能支持一行,取消之后数据消息，不会触发 dataSource\n   *\n   * @param row\n   * @param options\n   * @name 增加新的行\n   */\n  var addEditRecord = useRefFunction(function (row, options) {\n    if (options !== null && options !== void 0 && options.parentKey && !dataSourceKeyIndexMapRef.current.has(recordKeyToString(options === null || options === void 0 ? void 0 : options.parentKey).toString())) {\n      console.warn(\"can't find record by key\", options === null || options === void 0 ? void 0 : options.parentKey);\n      return false;\n    }\n    // 暂时不支持多行新增\n    if (newLineRecordRef.current && props.onlyAddOneLineAlertMessage !== false) {\n      warning(props.onlyAddOneLineAlertMessage || intl.getMessage('editableTable.onlyAddOneLine', '只能新增一行'));\n      return false;\n    }\n    // 如果是单行的话，不允许多行编辑\n    if (editableKeysSet.size > 0 && editableType === 'single' && props.onlyOneLineEditorAlertMessage !== false) {\n      warning(props.onlyOneLineEditorAlertMessage || intl.getMessage('editableTable.onlyOneLineEditor', '只能同时编辑一行'));\n      return false;\n    }\n    // 防止多次渲染\n    var recordKey = props.getRowKey(row, -1);\n    if (!recordKey && recordKey !== 0) {\n      noteOnce(!!recordKey, '请设置 recordCreatorProps.record 并返回一个唯一的key  \\n  https://procomponents.ant.design/components/editable-table#editable-%E6%96%B0%E5%BB%BA%E8%A1%8C');\n      throw new Error('请设置 recordCreatorProps.record 并返回一个唯一的key');\n    }\n    editableKeysSet.add(recordKey);\n    setEditableRowKeys(Array.from(editableKeysSet));\n\n    // 如果是dataSource 新增模式的话，取消再开始编辑，\n    // 这样就可以把新增到 dataSource的数据进入编辑模式了\n    // [a,b,cache] => [a,b,c]\n    if ((options === null || options === void 0 ? void 0 : options.newRecordType) === 'dataSource' || props.tableName) {\n      var _recordKeyToString3;\n      var actionProps = {\n        data: props.dataSource,\n        getRowKey: props.getRowKey,\n        row: _objectSpread(_objectSpread({}, row), {}, {\n          map_row_parentKey: options !== null && options !== void 0 && options.parentKey ? (_recordKeyToString3 = recordKeyToString(options === null || options === void 0 ? void 0 : options.parentKey)) === null || _recordKeyToString3 === void 0 ? void 0 : _recordKeyToString3.toString() : undefined\n        }),\n        key: recordKey,\n        childrenColumnName: props.childrenColumnName || 'children'\n      };\n      props.setDataSource(editableRowByKey(actionProps, (options === null || options === void 0 ? void 0 : options.position) === 'top' ? 'top' : 'update'));\n    } else {\n      setNewLineRecordCache({\n        defaultValue: row,\n        options: _objectSpread(_objectSpread({}, options), {}, {\n          recordKey: recordKey\n        })\n      });\n    }\n    return true;\n  });\n  var saveText = (props === null || props === void 0 ? void 0 : props.saveText) || intl.getMessage('editableTable.action.save', '保存');\n  var deleteText = (props === null || props === void 0 ? void 0 : props.deleteText) || intl.getMessage('editableTable.action.delete', '删除');\n  var cancelText = (props === null || props === void 0 ? void 0 : props.cancelText) || intl.getMessage('editableTable.action.cancel', '取消');\n  var actionSaveRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref11 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(recordKey, editRow, originRow, newLine) {\n      var _props$onSave, _recordKeyToString4, _options$parentKey;\n      var res, _ref12, options, actionProps;\n      return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n        while (1) switch (_context8.prev = _context8.next) {\n          case 0:\n            _context8.next = 2;\n            return props === null || props === void 0 || (_props$onSave = props.onSave) === null || _props$onSave === void 0 ? void 0 : _props$onSave.call(props, recordKey, editRow, originRow, newLine);\n          case 2:\n            res = _context8.sent;\n            _context8.next = 5;\n            return cancelEditable(recordKey);\n          case 5:\n            _ref12 = newLine || newLineRecordRef.current || {}, options = _ref12.options;\n            if (!(!(options !== null && options !== void 0 && options.parentKey) && (options === null || options === void 0 ? void 0 : options.recordKey) === recordKey)) {\n              _context8.next = 9;\n              break;\n            }\n            if ((options === null || options === void 0 ? void 0 : options.position) === 'top') {\n              props.setDataSource([editRow].concat(_toConsumableArray(props.dataSource)));\n            } else {\n              props.setDataSource([].concat(_toConsumableArray(props.dataSource), [editRow]));\n            }\n            return _context8.abrupt(\"return\", res);\n          case 9:\n            actionProps = {\n              data: props.dataSource,\n              getRowKey: props.getRowKey,\n              row: options ? _objectSpread(_objectSpread({}, editRow), {}, {\n                map_row_parentKey: (_recordKeyToString4 = recordKeyToString((_options$parentKey = options === null || options === void 0 ? void 0 : options.parentKey) !== null && _options$parentKey !== void 0 ? _options$parentKey : '')) === null || _recordKeyToString4 === void 0 ? void 0 : _recordKeyToString4.toString()\n              }) : editRow,\n              key: recordKey,\n              childrenColumnName: props.childrenColumnName || 'children'\n            };\n            props.setDataSource(editableRowByKey(actionProps, (options === null || options === void 0 ? void 0 : options.position) === 'top' ? 'top' : 'update'));\n            _context8.next = 13;\n            return cancelEditable(recordKey);\n          case 13:\n            return _context8.abrupt(\"return\", res);\n          case 14:\n          case \"end\":\n            return _context8.stop();\n        }\n      }, _callee8);\n    }));\n    return function (_x7, _x8, _x9, _x10) {\n      return _ref11.apply(this, arguments);\n    };\n  }());\n  var actionDeleteRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref13 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(recordKey, editRow) {\n      var _props$onDelete2;\n      var actionProps, res;\n      return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n        while (1) switch (_context9.prev = _context9.next) {\n          case 0:\n            actionProps = {\n              data: props.dataSource,\n              getRowKey: props.getRowKey,\n              row: editRow,\n              key: recordKey,\n              childrenColumnName: props.childrenColumnName || 'children'\n            };\n            _context9.next = 3;\n            return props === null || props === void 0 || (_props$onDelete2 = props.onDelete) === null || _props$onDelete2 === void 0 ? void 0 : _props$onDelete2.call(props, recordKey, editRow);\n          case 3:\n            res = _context9.sent;\n            _context9.next = 6;\n            return cancelEditable(recordKey, false);\n          case 6:\n            props.setDataSource(editableRowByKey(actionProps, 'delete'));\n            return _context9.abrupt(\"return\", res);\n          case 8:\n          case \"end\":\n            return _context9.stop();\n        }\n      }, _callee9);\n    }));\n    return function (_x11, _x12) {\n      return _ref13.apply(this, arguments);\n    };\n  }());\n  var actionCancelRef = useRefFunction( /*#__PURE__*/function () {\n    var _ref14 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10(recordKey, editRow, originRow, newLine) {\n      var _props$onCancel;\n      var res;\n      return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n        while (1) switch (_context10.prev = _context10.next) {\n          case 0:\n            _context10.next = 2;\n            return props === null || props === void 0 || (_props$onCancel = props.onCancel) === null || _props$onCancel === void 0 ? void 0 : _props$onCancel.call(props, recordKey, editRow, originRow, newLine);\n          case 2:\n            res = _context10.sent;\n            return _context10.abrupt(\"return\", res);\n          case 4:\n          case \"end\":\n            return _context10.stop();\n        }\n      }, _callee10);\n    }));\n    return function (_x13, _x14, _x15, _x16) {\n      return _ref14.apply(this, arguments);\n    };\n  }());\n\n  // 如果传入了自定义的actionRender，使用useRefFunction以确保内部的事件处理函数可以访问最新的state\n  var existCustomActionRender = props.actionRender && typeof props.actionRender === 'function';\n  var customActionRender = existCustomActionRender ? props.actionRender : function () {};\n  var customActionRenderRef = useRefFunction(customActionRender);\n  var actionRender = function actionRender(row) {\n    var key = props.getRowKey(row, row.index);\n    var config = {\n      saveText: saveText,\n      cancelText: cancelText,\n      deleteText: deleteText,\n      addEditRecord: addEditRecord,\n      recordKey: key,\n      cancelEditable: cancelEditable,\n      index: row.index,\n      tableName: props.tableName,\n      newLineConfig: newLineRecordCache,\n      onCancel: actionCancelRef,\n      onDelete: actionDeleteRef,\n      onSave: actionSaveRef,\n      editableKeys: editableKeys,\n      setEditableRowKeys: setEditableRowKeys,\n      preEditRowRef: preEditRowRef,\n      deletePopconfirmMessage: props.deletePopconfirmMessage || \"\".concat(intl.getMessage('deleteThisLine', '删除此项'), \"?\")\n    };\n    var renderResult = defaultActionRender(row, config);\n    // 缓存一下saveRef\n    if (props.tableName) {\n      saveRefsMap.current.set(dataSourceKeyIndexMapRef.current.get(recordKeyToString(key)) || recordKeyToString(key), renderResult.saveRef);\n    } else {\n      saveRefsMap.current.set(recordKeyToString(key), renderResult.saveRef);\n    }\n    if (existCustomActionRender) return customActionRenderRef(row, config, {\n      save: renderResult.save,\n      delete: renderResult.delete,\n      cancel: renderResult.cancel\n    });\n    return [renderResult.save, renderResult.delete, renderResult.cancel];\n  };\n  return {\n    editableKeys: editableKeys,\n    setEditableRowKeys: setEditableRowKeys,\n    isEditable: isEditable,\n    actionRender: actionRender,\n    startEditable: startEditable,\n    cancelEditable: cancelEditable,\n    addEditRecord: addEditRecord,\n    saveEditable: saveEditable,\n    newLineRecord: newLineRecordCache,\n    preEditableKeys: editableKeysRef,\n    onValuesChange: onValuesChange,\n    getRealIndex: props.getRealIndex\n  };\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}