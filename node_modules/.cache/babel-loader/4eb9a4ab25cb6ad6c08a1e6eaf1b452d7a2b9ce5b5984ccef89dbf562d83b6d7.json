{"ast":null,"code":"var _jsxFileName = \"/Users/phanluc/admin-web-fe/src/contexts/AuthContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport apiService from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [isAuth, setIsAuth] = useState(false);\n  const [authorities, setAuthorities] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      apiService.get('account').then(res => {\n        if (res.activated) {\n          setIsAuth(true);\n          setAuthorities(res.authorities || []);\n        }\n      }).catch(() => setIsAuth(false)).finally(() => setLoading(false));\n    } else {\n      setLoading(false);\n      setIsAuth(false);\n      navigate('/login');\n    }\n  }, []);\n  const loginRedirect = () => {\n    if (!isAuth && !loading) {\n      navigate('/login');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      isAuth,\n      authorities,\n      setIsAuth,\n      loginRedirect\n    },\n    children: !loading ? children : /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 36\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 39,\n    columnNumber: 9\n  }, this);\n};\n_s(AuthProvider, \"fD+vKpYQoqkNedHcDqcfSnlaRnI=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthProvider;\nexport default AuthContext;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useNavigate","apiService","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","isAuth","setIsAuth","authorities","setAuthorities","loading","setLoading","navigate","token","localStorage","getItem","get","then","res","activated","catch","finally","loginRedirect","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/phanluc/admin-web-fe/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport apiService from '../services/api';\n\nconst AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n    const [isAuth, setIsAuth] = useState(false);\n    const [authorities, setAuthorities] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const navigate = useNavigate();\n\n    useEffect(() => {\n        const token = localStorage.getItem('token');\n        if (token) {\n            apiService.get('account')\n                .then((res) => {\n                    if (res.activated) {\n                        setIsAuth(true);\n                        setAuthorities(res.authorities || []);\n                    }\n                })\n                .catch(() => setIsAuth(false))\n                .finally(() => setLoading(false));\n        } else {\n            setLoading(false);\n            setIsAuth(false);\n            navigate('/login');\n        }\n    }, []);\n\n    const loginRedirect = () => {\n        if (!isAuth && !loading) {\n            navigate('/login');\n        }\n    };\n\n    return (\n        <AuthContext.Provider value={{ isAuth, authorities, setIsAuth, loginRedirect }}>\n            {!loading ? children : <p>Loading...</p>}\n        </AuthContext.Provider>\n    );\n};\n\nexport default AuthContext;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AACjE,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,OAAOC,UAAU,MAAM,iBAAiB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEzC,MAAMC,WAAW,gBAAGP,aAAa,CAAC,CAAC;AAEnC,OAAO,MAAMQ,YAAY,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EAC1C,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGX,QAAQ,CAAC,KAAK,CAAC;EAC3C,MAAM,CAACY,WAAW,EAAEC,cAAc,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAACc,OAAO,EAAEC,UAAU,CAAC,GAAGf,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAMgB,QAAQ,GAAGd,WAAW,CAAC,CAAC;EAE9BD,SAAS,CAAC,MAAM;IACZ,MAAMgB,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,IAAIF,KAAK,EAAE;MACPd,UAAU,CAACiB,GAAG,CAAC,SAAS,CAAC,CACpBC,IAAI,CAAEC,GAAG,IAAK;QACX,IAAIA,GAAG,CAACC,SAAS,EAAE;UACfZ,SAAS,CAAC,IAAI,CAAC;UACfE,cAAc,CAACS,GAAG,CAACV,WAAW,IAAI,EAAE,CAAC;QACzC;MACJ,CAAC,CAAC,CACDY,KAAK,CAAC,MAAMb,SAAS,CAAC,KAAK,CAAC,CAAC,CAC7Bc,OAAO,CAAC,MAAMV,UAAU,CAAC,KAAK,CAAC,CAAC;IACzC,CAAC,MAAM;MACHA,UAAU,CAAC,KAAK,CAAC;MACjBJ,SAAS,CAAC,KAAK,CAAC;MAChBK,QAAQ,CAAC,QAAQ,CAAC;IACtB;EACJ,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMU,aAAa,GAAGA,CAAA,KAAM;IACxB,IAAI,CAAChB,MAAM,IAAI,CAACI,OAAO,EAAE;MACrBE,QAAQ,CAAC,QAAQ,CAAC;IACtB;EACJ,CAAC;EAED,oBACIX,OAAA,CAACC,WAAW,CAACqB,QAAQ;IAACC,KAAK,EAAE;MAAElB,MAAM;MAAEE,WAAW;MAAED,SAAS;MAAEe;IAAc,CAAE;IAAAlB,QAAA,EAC1E,CAACM,OAAO,GAAGN,QAAQ,gBAAGH,OAAA;MAAAG,QAAA,EAAG;IAAU;MAAAqB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACtB,CAAC;AAE/B,CAAC;AAACvB,EAAA,CApCWF,YAAY;EAAA,QAIJL,WAAW;AAAA;AAAA+B,EAAA,GAJnB1B,YAAY;AAsCzB,eAAeD,WAAW;AAAC,IAAA2B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}